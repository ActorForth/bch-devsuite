#!/usr/bin/env bash
set -e

if [ -f "./Electron-Cash-SLP/merkle.txt" ]; then
	if [[ ! -z $1 ]]; then
		# This will run the user's command, and also generate 5 blocks
		docker-compose exec bitcoind-regtest bitcoin-cli $@
		docker-compose exec bitcoind-regtest bitcoin-cli generate 5
	else
		# If the user gave no arguments, we'll just generate 10 blocks
		echo "Generating 10 blocks..."
		docker-compose exec bitcoind-regtest bitcoin-cli generate 10
		echo "Blocks generated."
	fi
else
	echo "Use this fix script AFTER ./setup and ./run"
	echo "Please note, the wallet should be actively running when you use this script."
fi
